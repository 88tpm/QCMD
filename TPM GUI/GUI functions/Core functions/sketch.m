function [figure_count] = sketch(x_data,y_data,z_data,title_text,figure_number,z_start,z_fin,colour,publication,x_name,y_name)

% This creates the standard 3D surface mesh plot for the voinova plot. It
% takes the x, y, z data first followed by the title and then figure number.
% It will plot the graph and then pass back a new figure number to be used
% in the parent piece of code.
% The final two variables can be left at zero if not needed.

% x_data --------->     x axsis as a vector
% y_data --------->     y axsis as a vector
% z_data --------->     z mesh data as a square matrix
% title_text ----->     string for the title
% figure_number -->     number of current figure in parent programme
% z_start -------->     if needed fixed z start value
% z_fin ---------->     if needed fixed z end value

% Selecting which type of graph to plot
%------------------------------------------------------------------------------------------------------------------------------------
if publication && strcmp(colour,'contour')
    % Create figure
    this_figure = figure(figure_number);
    this_figure = figure('Color',[1 1 1]);
    % Create axes
    axes1 = axes('Parent',this_figure,'YScale','log','YMinorTick','on','YMinorGrid','on','YDir','reverse','XDir','reverse',...
        'XScale','log','XMinorTick','on','XMinorGrid','on','Position',[0.22 0.21 0.66 0.76],'FontSize',20);
    set(gca, 'Clim', [z_start,z_fin])
    colormap([0.208100005984306 0.166299998760223 0.52920001745224;0.208100005984306 0.168977782130241 0.534677267074585;0.208100005984306 0.171655550599098 0.54015451669693;0.208100005984306 0.174333333969116 0.545631766319275;0.208100005984306 0.177011117339134 0.55110901594162;0.208100005984306 0.179688885807991 0.556586265563965;0.208100005984306 0.182366669178009 0.56206351518631;0.208100005984306 0.185044452548027 0.567540764808655;0.208100005984306 0.187722221016884 0.573018014431;0.208100005984306 0.190400004386902 0.578495264053345;0.0478761903941631 0.57690155506134 0.821992039680481;0.046522855758667 0.578869462013245 0.821778059005737;0.0451695248484612 0.580837428569794 0.821564078330994;0.043816190212965 0.582805395126343 0.821350157260895;0.0424628593027592 0.584773302078247 0.821136176586151;0.041109524667263 0.586741209030151 0.820922195911407;0.0397561900317669 0.5887091755867 0.820708215236664;0.0384028591215611 0.59067714214325 0.82049423456192;0.0370495244860649 0.592645049095154 0.820280313491821;0.0356961935758591 0.594612956047058 0.820066332817078;0.0343428589403629 0.596580922603607 0.819852352142334;0.0369244180619717 0.597101390361786 0.818170547485352;0.0395059809088707 0.597621917724609 0.816488683223724;0.0420875400304794 0.598142385482788 0.814806818962097;0.0446691028773785 0.598662853240967 0.813125014305115;0.0472506619989872 0.599183320999146 0.811443209648132;0.0498322211205959 0.599703848361969 0.809761345386505;0.052413783967495 0.600224316120148 0.808079481124878;0.0549953430891037 0.600744783878326 0.806397676467896;0.0575769059360027 0.60126531124115 0.804715871810913;0.0601584650576115 0.601785778999329 0.803034007549286;0.550655007362366 0.700677514076233 0.483485043048859;0.553236544132233 0.701197981834412 0.481803208589554;0.555818140506744 0.701718509197235 0.480121374130249;0.558399677276611 0.702238976955414 0.478439539670944;0.560981273651123 0.702759444713593 0.476757705211639;0.56356281042099 0.703279972076416 0.475075840950012;0.566144347190857 0.703800439834595 0.473394006490707;0.568725943565369 0.704320907592773 0.471712172031403;0.571307480335236 0.704841375350952 0.470030337572098;0.573889076709747 0.705361902713776 0.468348503112793;0.576470613479614 0.705882370471954 0.466666668653488;0.579948127269745 0.706212162971497 0.464780688285828;0.583425641059875 0.706541955471039 0.462894678115845;0.586903154850006 0.706871747970581 0.461008697748184;0.590380668640137 0.707201540470123 0.459122687578201;0.593858122825623 0.707531332969666 0.457236707210541;0.597335636615753 0.707861125469208 0.45535072684288;0.600813150405884 0.70819091796875 0.453464716672897;0.604290664196014 0.708520710468292 0.451578736305237;0.607768177986145 0.708850502967834 0.449692726135254;0.611245691776276 0.709180295467377 0.447806745767593;0.959823787212372 0.921833336353302 0.094838097691536;0.961321651935577 0.927403032779694 0.0911073610186577;0.962819457054138 0.932972729206085 0.0873766243457794;0.964317321777344 0.938542425632477 0.0836458876729012;0.965815126895905 0.944112122058868 0.0799151510000229;0.96731299161911 0.94968181848526 0.0761844143271446;0.968810796737671 0.955251514911652 0.072453685104847;0.970308661460876 0.960821211338043 0.0687229484319687;0.971806466579437 0.966390907764435 0.0649922117590904;0.973304331302643 0.971960604190826 0.0612614750862122;0.974802136421204 0.977530300617218 0.0575307384133339;0.976300001144409 0.98309999704361 0.0538000017404556]);
%     colormap([0.208100005984306 0.166299998760223 0.52920001745224;0.199263632297516 0.19641637802124 0.543720424175262;0.190427258610725 0.226532742381096 0.55824077129364;0.181590884923935 0.256649106740952 0.572761178016663;0.172754511237144 0.286765486001968 0.587281584739685;0.163918137550354 0.316881865262985 0.601801991462708;0.155081763863564 0.346998244524002 0.61632239818573;0.146245390176773 0.377114623785019 0.630842745304108;0.137409031391144 0.407230973243713 0.64536315202713;0.128572657704353 0.43734735250473 0.659883558750153;0.119736276566982 0.467463731765747 0.67440390586853;0.110899902880192 0.497580111026764 0.688924312591553;0.102063536643982 0.527696490287781 0.703444719314575;0.0932271629571915 0.557812869548798 0.717965126037598;0.084390789270401 0.587929248809814 0.73248553276062;0.0755544155836105 0.618045568466187 0.747005879878998;0.0667180418968201 0.648161947727203 0.76152628660202;0.0578816682100296 0.67827832698822 0.776046693325043;0.0490452945232391 0.708394706249237 0.79056704044342;0.040208924561739 0.738511085510254 0.805087447166443;0.0313725508749485 0.768627464771271 0.819607853889465;0.077124185860157 0.778711497783661 0.791970133781433;0.122875817120075 0.788795530796051 0.764332413673401;0.168627455830574 0.798879563808441 0.736694693565369;0.214379087090492 0.808963596820831 0.709056973457336;0.260130733251572 0.819047629833221 0.681419253349304;0.30588236451149 0.829131662845612 0.653781533241272;0.351633995771408 0.839215695858002 0.62614381313324;0.397385627031326 0.849299728870392 0.598506093025208;0.443137258291245 0.859383761882782 0.570868372917175;0.488888889551163 0.869467794895172 0.543230652809143;0.534640550613403 0.879551827907562 0.515592932701111;0.580392181873322 0.889635860919952 0.487955182790756;0.62614381313324 0.899719893932343 0.460317462682724;0.671895444393158 0.909803926944733 0.432679742574692;0.717647075653076 0.919887959957123 0.40504202246666;0.763398706912994 0.929971992969513 0.377404302358627;0.809150338172913 0.940056025981903 0.349766582250595;0.854901969432831 0.950140058994293 0.322128862142563;0.900653600692749 0.960224092006683 0.294491142034531;0.946405231952667 0.970308125019073 0.266853421926498;0.992156863212585 0.980392158031464 0.239215686917305;0.991978585720062 0.961319088935852 0.230659544467926;0.991800367832184 0.94224601984024 0.222103387117386;0.991622090339661 0.923172891139984 0.213547244668007;0.991443872451782 0.904099822044373 0.204991087317467;0.991265594959259 0.885026752948761 0.196434944868088;0.991087317466736 0.865953683853149 0.187878787517548;0.990909099578857 0.846880555152893 0.179322645068169;0.990730822086334 0.827807486057281 0.170766487717628;0.990552604198456 0.80873441696167 0.16221034526825;0.990374326705933 0.789661347866058 0.153654187917709;0.990196108818054 0.770588278770447 0.14509804546833;0.990017831325531 0.75151515007019 0.13654188811779;0.989839553833008 0.732442080974579 0.127985745668411;0.989661335945129 0.713369011878967 0.119429588317871;0.989483058452606 0.694295942783356 0.110873438417912;0.989304840564728 0.675222814083099 0.102317288517952;0.989126563072205 0.656149744987488 0.0937611386179924;0.988948285579681 0.637076675891876 0.0852049887180328;0.988770067691803 0.618003606796265 0.0766488388180733;0.98859179019928 0.598930478096008 0.0680926889181137;0.988413572311401 0.579857409000397 0.0595365427434444;0.988235294818878 0.560784339904785 0.0509803928434849]);
    grid(axes1,'on');
    hold(axes1,'on');
    % Create contour
    contourf(x_data,y_data,z_data,'LevelStep',1,'Parent',axes1);
    set(0,'DefaultAxesFontName', 'Helvetica')
    %     annotation(this_figure,'textbox',[0.01 0.45 0.2 0.2],'String',{'Viscosity / Pa s'},'FitBoxToText','off','LineStyle','none','FontSize',22.5,'HorizontalAlignment','center'); % Comment beta 2 of 3
%     annotation(this_figure,'textbox',[0.4 0 0.3 0.1],'String',{'Shear / Pa'},'FitBoxToText','off','LineStyle','none','FontSize',22.5); % Comment beta 3 of 3
    xlabel('Shear / Pa')
    ylabel('Viscosity / Pa s')
    colorbar('YTickLabel',{'XM','S','MM','A'})
    hold off
    a = size(x_data);
%     xlim(axes1,[x_data(1),x_data(a(1))]) % Uncomment for fixed x and y values
    a = size(y_data);
%     ylim(axes1,[y_data(1),y_data(a(1))]) % Uncomment for fixed x and y values
    set(gca,'XTick',[1e1 1e2 1e3 1e4 1e5 1e6 1e7]); % Uncomment for fixed x and y values
%------------------------------------------------------------------------------------------------------------------------------------
% If you select "Custom graph" in the GUI, it will run this section of the
% code to make a custom graph. You need to edit the following elseif
% publication code to get the specific graph you want plotted to plot. The
% code written for the McNamara and Blanford paper TPM-sensitivity plots
elseif publication
    % Create figure
    this_figure = figure(figure_number);
    this_figure = figure('Color',[1 1 1]);
    % Create axes
    axes1 = axes('Parent',this_figure,'YScale','log','YMinorTick','on','YMinorGrid','on',...
            'XScale','log','XMinorTick','on','XMinorGrid','on','Position',[0.196 0.12 0.716 0.815],'FontSize',20); % This is for mesh plots
        %   view(axes1,[-37.5 30]); % Comment alpha (standard view) 1 of 3
    view(axes1,[-205.5 30]); % Comment beta (fig 1 view) 1 of 3
    grid(axes1,'on');
    hold(axes1,'all');
    % Create mesh
    if strcmp('b',colour)
        z_data = z_data*1e6;
    end
     mesh(x_data,y_data,z_data,'Parent',axes1);
    set(0,'DefaultAxesFontName', 'Helvetica')
    if strcmp('auto',colour)
    else
        if strcmp('r',colour)
            colormap([0 0 1;0.0126984128728509 0.0126984128728509 0.996825397014618;0.0253968257457018 0.0253968257457018 0.993650794029236;0.0380952395498753 0.0380952395498753 0.990476191043854;0.0507936514914036 0.0507936514914036 0.987301588058472;0.0634920671582222 0.0634920671582222 0.98412698507309;0.0761904790997505 0.0761904790997505 0.980952382087708;0.0888888910412788 0.0888888910412788 0.977777779102325;0.101587302982807 0.101587302982807 0.974603176116943;0.114285714924335 0.114285714924335 0.971428573131561;0.126984134316444 0.126984134316444 0.968253970146179;0.139682546257973 0.139682546257973 0.965079367160797;0.152380958199501 0.152380958199501 0.961904764175415;0.165079370141029 0.165079370141029 0.958730161190033;0.177777782082558 0.177777782082558 0.955555558204651;0.190476194024086 0.190476194024086 0.952380955219269;0.203174605965614 0.203174605965614 0.949206352233887;0.215873017907143 0.215873017907143 0.946031749248505;0.228571429848671 0.228571429848671 0.942857146263123;0.241269841790199 0.241269841790199 0.93968254327774;0.253968268632889 0.253968268632889 0.936507940292358;0.266666680574417 0.266666680574417 0.933333337306976;0.279365092515945 0.279365092515945 0.930158734321594;0.292063504457474 0.292063504457474 0.926984131336212;0.304761916399002 0.304761916399002 0.92380952835083;0.31746032834053 0.31746032834053 0.920634925365448;0.330158740282059 0.330158740282059 0.917460322380066;0.342857152223587 0.342857152223587 0.914285719394684;0.355555564165115 0.355555564165115 0.911111116409302;0.368253976106644 0.368253976106644 0.90793651342392;0.380952388048172 0.380952388048172 0.904761910438538;0.3936507999897 0.3936507999897 0.901587307453156;0.406349211931229 0.406349211931229 0.898412704467773;0.419047623872757 0.419047623872757 0.895238101482391;0.431746035814285 0.431746035814285 0.892063498497009;0.444444447755814 0.444444447755814 0.888888895511627;0.457142859697342 0.457142859697342 0.885714292526245;0.46984127163887 0.46984127163887 0.882539689540863;0.482539683580399 0.482539683580399 0.879365086555481;0.495238095521927 0.495238095521927 0.876190483570099;0.507936537265778 0.507936537265778 0.873015880584717;0.520634949207306 0.520634949207306 0.869841277599335;0.533333361148834 0.533333361148834 0.866666674613953;0.546031773090363 0.546031773090363 0.863492071628571;0.558730185031891 0.558730185031891 0.860317468643188;0.571428596973419 0.571428596973419 0.857142865657806;0.584127008914948 0.584127008914948 0.853968262672424;0.596825420856476 0.596825420856476 0.850793659687042;0.609523832798004 0.609523832798004 0.84761905670166;0.622222244739532 0.622222244739532 0.844444453716278;0.634920656681061 0.634920656681061 0.841269850730896;0.647619068622589 0.647619068622589 0.838095247745514;0.660317480564117 0.660317480564117 0.834920644760132;0.673015892505646 0.673015892505646 0.83174604177475;0.685714304447174 0.685714304447174 0.828571438789368;0.698412716388702 0.698412716388702 0.825396835803986;0.711111128330231 0.711111128330231 0.822222232818604;0.723809540271759 0.723809540271759 0.819047629833221;0.736507952213287 0.736507952213287 0.815873026847839;0.749206364154816 0.749206364154816 0.812698423862457;0.761904776096344 0.761904776096344 0.809523820877075;0.774603188037872 0.774603188037872 0.806349217891693;0.787301599979401 0.787301599979401 0.803174614906311;0.800000011920929 0.800000011920929 0.800000011920929]);
            zlabel('\Deltaf / Hz','FontSize',22.5);
        elseif strcmp('b',colour)
            colormap([0.800000011920929 0.800000011920929 0.800000011920929;0.803174614906311 0.787301599979401 0.787301599979401;0.806349217891693 0.774603188037872 0.774603188037872;0.809523820877075 0.761904776096344 0.761904776096344;0.812698423862457 0.749206364154816 0.749206364154816;0.815873026847839 0.736507952213287 0.736507952213287;0.819047629833221 0.723809540271759 0.723809540271759;0.822222232818604 0.711111128330231 0.711111128330231;0.825396835803986 0.698412716388702 0.698412716388702;0.828571438789368 0.685714304447174 0.685714304447174;0.83174604177475 0.673015892505646 0.673015892505646;0.834920644760132 0.660317480564117 0.660317480564117;0.838095247745514 0.647619068622589 0.647619068622589;0.841269850730896 0.634920656681061 0.634920656681061;0.844444453716278 0.622222244739532 0.622222244739532;0.84761905670166 0.609523832798004 0.609523832798004;0.850793659687042 0.596825420856476 0.596825420856476;0.853968262672424 0.584127008914948 0.584127008914948;0.857142865657806 0.571428596973419 0.571428596973419;0.860317468643188 0.558730185031891 0.558730185031891;0.863492071628571 0.546031773090363 0.546031773090363;0.866666674613953 0.533333361148834 0.533333361148834;0.869841277599335 0.520634949207306 0.520634949207306;0.873015880584717 0.507936537265778 0.507936537265778;0.876190483570099 0.495238095521927 0.495238095521927;0.879365086555481 0.482539683580399 0.482539683580399;0.882539689540863 0.46984127163887 0.46984127163887;0.885714292526245 0.457142859697342 0.457142859697342;0.888888895511627 0.444444447755814 0.444444447755814;0.892063498497009 0.431746035814285 0.431746035814285;0.895238101482391 0.419047623872757 0.419047623872757;0.898412704467773 0.406349211931229 0.406349211931229;0.901587307453156 0.3936507999897 0.3936507999897;0.904761910438538 0.380952388048172 0.380952388048172;0.90793651342392 0.368253976106644 0.368253976106644;0.911111116409302 0.355555564165115 0.355555564165115;0.914285719394684 0.342857152223587 0.342857152223587;0.917460322380066 0.330158740282059 0.330158740282059;0.920634925365448 0.31746032834053 0.31746032834053;0.92380952835083 0.304761916399002 0.304761916399002;0.926984131336212 0.292063504457474 0.292063504457474;0.930158734321594 0.279365092515945 0.279365092515945;0.933333337306976 0.266666680574417 0.266666680574417;0.936507940292358 0.253968268632889 0.253968268632889;0.93968254327774 0.241269841790199 0.241269841790199;0.942857146263123 0.228571429848671 0.228571429848671;0.946031749248505 0.215873017907143 0.215873017907143;0.949206352233887 0.203174605965614 0.203174605965614;0.952380955219269 0.190476194024086 0.190476194024086;0.955555558204651 0.177777782082558 0.177777782082558;0.958730161190033 0.165079370141029 0.165079370141029;0.961904764175415 0.152380958199501 0.152380958199501;0.965079367160797 0.139682546257973 0.139682546257973;0.968253970146179 0.126984134316444 0.126984134316444;0.971428573131561 0.114285714924335 0.114285714924335;0.974603176116943 0.101587302982807 0.101587302982807;0.977777779102325 0.0888888910412788 0.0888888910412788;0.980952382087708 0.0761904790997505 0.0761904790997505;0.98412698507309 0.0634920671582222 0.0634920671582222;0.987301588058472 0.0507936514914036 0.0507936514914036;0.990476191043854 0.0380952395498753 0.0380952395498753;0.993650794029236 0.0253968257457018 0.0253968257457018;0.996825397014618 0.0126984128728509 0.0126984128728509;1 0 0]);
            zlabel('\Deltad / ppm','FontSize',22.5);
        elseif strcmp('g',colour)
            colormap([0.800000011920929 0.800000011920929 0.800000011920929;0.787301599979401 0.799190819263458 0.787363827228546;0.774603188037872 0.798381567001343 0.774727702140808;0.761904776096344 0.797572374343872 0.762091517448425;0.749206364154816 0.796763181686401 0.749455332756042;0.736507952213287 0.795953929424286 0.736819207668304;0.723809540271759 0.795144736766815 0.724183022975922;0.711111128330231 0.794335544109344 0.711546838283539;0.698412716388702 0.793526291847229 0.698910713195801;0.685714304447174 0.792717099189758 0.686274528503418;0.673015892505646 0.791907906532288 0.673638343811035;0.660317480564117 0.791098654270172 0.661002159118652;0.647619068622589 0.790289461612701 0.648366034030914;0.634920656681061 0.789480268955231 0.635729849338531;0.622222244739532 0.788671016693115 0.623093664646149;0.609523832798004 0.787861824035645 0.610457539558411;0.596825420856476 0.787052631378174 0.597821354866028;0.584127008914948 0.786243379116058 0.585185170173645;0.571428596973419 0.785434186458588 0.572549045085907;0.558730185031891 0.784624993801117 0.559912860393524;0.546031773090363 0.783815741539001 0.547276675701141;0.533333361148834 0.783006548881531 0.534640550613403;0.520634949207306 0.78219735622406 0.522004365921021;0.507936537265778 0.781388103961945 0.509368181228638;0.495238095521927 0.780578911304474 0.496732026338577;0.482539683580399 0.779769718647003 0.484095871448517;0.46984127163887 0.778960466384888 0.471459716558456;0.457142859697342 0.778151273727417 0.458823531866074;0.444444447755814 0.777342081069946 0.446187376976013;0.431746035814285 0.776532828807831 0.43355119228363;0.419047623872757 0.77572363615036 0.42091503739357;0.406349211931229 0.774914443492889 0.40827888250351;0.3936507999897 0.774105191230774 0.395642697811127;0.380952388048172 0.773295998573303 0.383006542921066;0.368253976106644 0.772486805915833 0.370370388031006;0.355555564165115 0.771677553653717 0.357734203338623;0.342857152223587 0.770868360996246 0.345098048448563;0.330158740282059 0.770059168338776 0.332461893558502;0.31746032834053 0.76924991607666 0.319825708866119;0.304761916399002 0.768440723419189 0.307189553976059;0.292063504457474 0.767631530761719 0.294553369283676;0.279365092515945 0.766822278499603 0.281917214393616;0.266666680574417 0.766013085842133 0.269281059503555;0.253968268632889 0.765203893184662 0.256644874811172;0.241269841790199 0.764394640922546 0.244008719921112;0.228571429848671 0.763585448265076 0.23137255012989;0.215873017907143 0.762776255607605 0.218736380338669;0.203174605965614 0.76196700334549 0.206100225448608;0.190476194024086 0.761157810688019 0.193464055657387;0.177777782082558 0.760348618030548 0.180827885866165;0.165079370141029 0.759539365768433 0.168191730976105;0.152380958199501 0.758730173110962 0.155555561184883;0.139682546257973 0.757920980453491 0.142919391393662;0.126984134316444 0.757111728191376 0.13028322160244;0.114285714924335 0.756302535533905 0.117647059261799;0.101587302982807 0.755493342876434 0.105010896921158;0.0888888910412788 0.754684090614319 0.0923747271299362;0.0761904790997505 0.753874897956848 0.0797385647892952;0.0634920671582222 0.753065705299377 0.0671023949980736;0.0507936514914036 0.752256453037262 0.0544662326574326;0.0380952395498753 0.751447260379791 0.0418300665915012;0.0253968257457018 0.750638067722321 0.0291939005255699;0.0126984128728509 0.749828815460205 0.0165577344596386;0 0.749019622802734 0.00392156885936856]);
            zlabel({'TPM-sensitivity'},'FontSize',22.5);
        elseif strcmp('mm',colour)
            colormap([0.800000011920929 0.800000011920929 0.800000011920929;0.803174614906311 0.787301599979401 0.803174614906311;0.806349217891693 0.774603188037872 0.806349217891693;0.809523820877075 0.761904776096344 0.809523820877075;0.812698423862457 0.749206364154816 0.812698423862457;0.815873026847839 0.736507952213287 0.815873026847839;0.819047629833221 0.723809540271759 0.819047629833221;0.822222232818604 0.711111128330231 0.822222232818604;0.825396835803986 0.698412716388702 0.825396835803986;0.828571438789368 0.685714304447174 0.828571438789368;0.83174604177475 0.673015892505646 0.83174604177475;0.834920644760132 0.660317480564117 0.834920644760132;0.838095247745514 0.647619068622589 0.838095247745514;0.841269850730896 0.634920656681061 0.841269850730896;0.844444453716278 0.622222244739532 0.844444453716278;0.84761905670166 0.609523832798004 0.84761905670166;0.850793659687042 0.596825420856476 0.850793659687042;0.853968262672424 0.584127008914948 0.853968262672424;0.857142865657806 0.571428596973419 0.857142865657806;0.860317468643188 0.558730185031891 0.860317468643188;0.863492071628571 0.546031773090363 0.863492071628571;0.866666674613953 0.533333361148834 0.866666674613953;0.869841277599335 0.520634949207306 0.869841277599335;0.873015880584717 0.507936537265778 0.873015880584717;0.876190483570099 0.495238095521927 0.876190483570099;0.879365086555481 0.482539683580399 0.879365086555481;0.882539689540863 0.46984127163887 0.882539689540863;0.885714292526245 0.457142859697342 0.885714292526245;0.888888895511627 0.444444447755814 0.888888895511627;0.892063498497009 0.431746035814285 0.892063498497009;0.895238101482391 0.419047623872757 0.895238101482391;0.898412704467773 0.406349211931229 0.898412704467773;0.901587307453156 0.3936507999897 0.901587307453156;0.904761910438538 0.380952388048172 0.904761910438538;0.90793651342392 0.368253976106644 0.90793651342392;0.911111116409302 0.355555564165115 0.911111116409302;0.914285719394684 0.342857152223587 0.914285719394684;0.917460322380066 0.330158740282059 0.917460322380066;0.920634925365448 0.31746032834053 0.920634925365448;0.92380952835083 0.304761916399002 0.92380952835083;0.926984131336212 0.292063504457474 0.926984131336212;0.930158734321594 0.279365092515945 0.930158734321594;0.933333337306976 0.266666680574417 0.933333337306976;0.936507940292358 0.253968268632889 0.936507940292358;0.93968254327774 0.241269841790199 0.93968254327774;0.942857146263123 0.228571429848671 0.942857146263123;0.946031749248505 0.215873017907143 0.946031749248505;0.949206352233887 0.203174605965614 0.949206352233887;0.952380955219269 0.190476194024086 0.952380955219269;0.955555558204651 0.177777782082558 0.955555558204651;0.958730161190033 0.165079370141029 0.958730161190033;0.961904764175415 0.152380958199501 0.961904764175415;0.965079367160797 0.139682546257973 0.965079367160797;0.968253970146179 0.126984134316444 0.968253970146179;0.971428573131561 0.114285714924335 0.971428573131561;0.974603176116943 0.101587302982807 0.974603176116943;0.977777779102325 0.0888888910412788 0.977777779102325;0.980952382087708 0.0761904790997505 0.980952382087708;0.98412698507309 0.0634920671582222 0.98412698507309;0.987301588058472 0.0507936514914036 0.987301588058472;0.990476191043854 0.0380952395498753 0.990476191043854;0.993650794029236 0.0253968257457018 0.993650794029236;0.996825397014618 0.0126984128728509 0.996825397014618;1 0 1]);
            zlabel({'Missing Mass / %'},'FontSize',22.5);
        else
            error('Colour selection must be r, b, g, or auto for auto colour assignment')
        end
    end
% -------------- Uncomment by one the next 6 lines to revert back to sketch
    % xlabel('Shear / Pa','FontSize',22.5);
    %  ylabel('Viscosity / Pa s','FontSize',22.5);
%     annotation(this_figure,'textbox',[0.08 0 0.05 0.1],'String',{'Viscosity / Pa s'},'FitBoxToText','off','LineStyle','none','FontSize',22.5); % Comment alpha 2 of 3
%     annotation(this_figure,'textbox',[0.52 0 0.3 0.1],'String',{'Shear / Pa'},'FitBoxToText','off','LineStyle','none','FontSize',22.5); % Comment alpha 3 of 3
%  Annotations for mesh plots
    annotation(this_figure,'textbox',[0.02 0 0.2 0.2],'String',{'Viscosity / Pa s'},'FitBoxToText','off','LineStyle','none','FontSize',22.5,'HorizontalAlignment','center'); % Comment beta 2 of 3
    annotation(this_figure,'textbox',[0.64 0 0.3 0.1],'String',{'Shear / Pa'},'FitBoxToText','off','LineStyle','none','FontSize',22.5); % Comment beta 3 of 3
    % title(title_text,'FontSize',27.5);
    % Create colorbar
    box on
    hold off
    a = size(x_data);
    xlim(axes1,[x_data(1),x_data(a(1))])
    a = size(y_data);
    ylim(axes1,[y_data(1),y_data(a(1))])
    if or((z_start ~= 0),(z_fin ~= 0))
        zlim(axes1,[z_start,z_fin])
        caxis([z_start,z_fin])
    end

%     annotation(this_figure,'textbox',[0.315 0.03 0.1 0.1],'String',{'10^-^3'},'FitBoxToText','off','LineStyle','none','FontSize',20);
%      annotation(this_figure,'textbox',[0.419285714285715 0.034 0.0821428571428572 0.0761904761904762],'String',{'10^9'},'FitBoxToText','off','LineStyle','none','FontSize',20);
%     x = [1e4 1e5 1e6 1e7]; set(gca,'XTick',x);
    x = [1e4 1e5 1e6 1e7 1e8 1e9]; set(gca,'XTick',x);
    y = [1e-3 1e-2 1e-1 1]; set(gca,'YTick',y);
    disp('WARNING x and y axis labels are set in the code and do not change automatically, to autoformat the axis turn off "publication" in controls')
%------------------------------------------------------------------------------------------------------------------------------------
elseif publication == 0
    % x_data --------->     x axis as a vector
    % y_data --------->     y axis as a vector
    % z_data --------->     z mesh data as a square matrix
    % title_text ----->     string for the title
    % figure_number -->     number of current figure in parent programme
    % z_start -------->     if needed fixed z start value
    % z_fin ---------->     if needed fixed z end value

    % Create figure
    this_figure = figure(figure_number);
    this_figure = figure('Color',[1 1 1]);
    % Create axes
    axes1 = axes('Parent',this_figure,'YScale','log','YMinorTick','on','YMinorGrid','on',...
        'XScale','log','XMinorTick','on','XMinorGrid','on','Position',[0.083 0.11 0.7 0.815]);
    
%     A selection of views for the graph
    view(axes1,[-205.5 30])
%     view(axes1,[-37.5 30]); % Standard view
%     view(axes1,[-205.5 30]); % Figure 1 view

    grid(axes1,'on');
    hold(axes1,'all');
    
    % Create mesh
    mesh(x_data,y_data,z_data,'Parent',axes1);
    annotation(this_figure,'textbox',[0.0 0 0.2 0.15],'String',{x_name},'FitBoxToText','off','LineStyle','none','FontSize',12,'HorizontalAlignment','center'); % Comment beta 2 of 3
    annotation(this_figure,'textbox',[0.5 0 0.3 0.1],'String',{y_name},'FitBoxToText','off','LineStyle','none','FontSize',12); % Comment beta 3 of 3
%     xlabel(x_name,'FontSize',12);
%     ylabel(y_name,'FontSize',12);
    title(title_text,'FontSize',14);
    
    % Create colorbar
    box on
    colorbar('peer',axes1,'Position',[0.85 0.11 0.02 0.815],'FontSize',12);
    hold off
    if or((z_start ~= 0),(z_fin ~= 0))
        zlim(axes1,[z_start,z_fin])
        caxis([z_start,z_fin])
    end
else
    error('publication setting must be either 1 or 0')
end
figure_count = figure_number+1;



